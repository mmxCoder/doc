# 如何等待分散在不同的模块内部的多个异步结束?

## 场景

> 在表格中, 表格的数据取决于其他的几个状态, 并且这几个状态都是异步获取的
> 这几个状态都分散在不同的几个模块内部, 那么该如何组织代码才可以比较友好的实现该需求. 

## 示例

<img src="/asyncAwait1.png" />

> 上面是一个最简单的示例复现.  
> 想象一下, 顶部的三个状态都是异步请求回来的, 并且有可能这三个是分布在 **`不同`** 的组件内部,  
> 表格需要等到这三个 **`异步结束`** 后再去请求数据.


:::info 思考

针对以上的场景, 应该如何组织代码才可以比较友好呢?  

:::

## 目前的解决方案

<img src="/asyncAwait2.png" />

:::warning 问题

这个方案看似解决了问题, 即多个模块可以单独调用加载方法, 不需要管其他状态是否结束.
最终的请求由表格内部去判断什么时候执行.  

但是, 这引发了其他的问题.

0. 调用方需要手动指定初始化时总共有多少个异步状态, 也就说初始化时需要调用多少次加载方法, 因为表格并不能感知这个条件,
所以无法判断啥时候需要发起请求.  
1. 如果存在多个状态, 但其中一个状态失败了, 这种情况将有点麻烦. 可能还需要手动指定是否需要发起请求.

:::